name: build and test
on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
  workflow_dispatch:
jobs:
# Harmony tests
  buildAndTestUbuntuHarmony:
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: ubuntu-latest
      dotnet_version: '6.0.x'
      hook_manager_type: Harmony
  buildAndTestWindowsHarmony:
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: windows-latest
      dotnet_version: '6.0.x'
      hook_manager_type: Harmony
  buildAndTestMacHarmony:
    runs-on: macos-latest
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: macos-latest
      dotnet_version: '6.0.x'
      hook_manager_type: Harmony
# MonoMod tests
  buildAndTestUbuntuMonoMod:
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: ubuntu-latest
      dotnet_version: '6.0.x'
      hook_manager_type: MonoMod
  buildAndTestWindowsMonoMod:
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: windows-latest
      dotnet_version: '6.0.x'
      hook_manager_type: MonoMod
  buildAndTestMacMonoMod:
    runs-on: macos-latest
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: macos-latest
      dotnet_version: '6.0.x'
      hook_manager_type: MonoMod
# Native tests
  buildAndTestUbuntuNative:
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: ubuntu-latest
      dotnet_version: '6.0.x'
      hook_manager_type: Native
  buildAndTestWindowsNative:
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: windows-latest
      dotnet_version: '6.0.x'
      hook_manager_type: Native
  buildAndTestMacNative:
    runs-on: macos-latest
    uses: ./.github/workflows/build_and_test_job.yaml
    with:
      os: macos-latest
      dotnet_version: '6.0.x'
      hook_manager_type: Native
